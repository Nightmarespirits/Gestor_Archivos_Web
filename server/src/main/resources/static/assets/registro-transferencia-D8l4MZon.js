import{J as h,r as c,u as S,K as l}from"./index-DTzO7a71.js";const N=h("registroTransferencia",()=>{const i=c([]),a=c(null),t=c(!1),o=c(null),u=S();function R(){return i.value}function T(){return a.value}function E(){return t.value}function m(){return o.value}c({page:0,size:10,totalItems:0,totalPages:0}),c({sortBy:"id",direction:"desc"});async function v(){try{t.value=!0;const e=await l.get("/inventarios/registro-transferencia",{debug:!0});return i.value=e||[],e}catch(e){return o.value=e.message,console.error("fetchRegistrosTransferencia Error:",e),i.value=[],[]}finally{t.value=!1}}async function g(e){try{t.value=!0;const r=await l.get(`/inventarios/registro-transferencia/${e}`);return a.value=r,r}catch(r){return o.value=r.message,console.error("fetchRegistroTransferenciaById Error:",r),null}finally{t.value=!1}}async function I(e){try{t.value=!0;const r=await l.post("/inventarios/registro-transferencia",e);return r&&r.id&&(await v(),await u.logActivity({action:"CREATE",entityType:"REGISTRO_TRANSFERENCIA",entityId:r.id,details:`Registro de Transferencia "${r.numero}" creado`})),r}catch(r){throw o.value=r.message,console.error("createRegistroTransferencia Error:",r),r}finally{t.value=!1}}async function p(e,r){try{t.value=!0;const n=a.value||await g(e),f=n?n.estado:null,s=await l.put(`/inventarios/registro-transferencia/${e}`,r);if(s){a.value&&a.value.id===e&&(a.value=s);const d=i.value.findIndex(A=>A.id===e);d!==-1&&(i.value[d]=s);let y=`Registro de Transferencia "${s.numero}" actualizado`;f&&s.estado&&f!==s.estado&&(y+=`. Estado cambiado de ${f} a ${s.estado}`),await u.logActivity({action:"UPDATE",entityType:"REGISTRO_TRANSFERENCIA",entityId:e,details:y})}return s}catch(n){throw o.value=n.message,console.error("updateRegistroTransferencia Error:",n),n}finally{t.value=!1}}async function w(e){try{t.value=!0;const r=i.value.find(n=>n.id===e)||(a.value&&a.value.id===e?a.value:null);return await l.delete(`/inventarios/registro-transferencia/${e}`),i.value=i.value.filter(n=>n.id!==e),a.value&&a.value.id===e&&(a.value=null),r&&await u.logActivity({action:"DELETE",entityType:"REGISTRO_TRANSFERENCIA",entityId:e,details:`Registro de Transferencia "${r.numero||e}" eliminado`}),!0}catch(r){return o.value=r.message,console.error("deleteRegistroTransferencia Error:",r),!1}finally{t.value=!1}}return{registrosTransferencia:i,currentRegistroTransferencia:a,loading:t,error:o,fetchRegistrosTransferencia:v,fetchRegistroTransferenciaById:g,createRegistroTransferencia:I,updateRegistroTransferencia:p,deleteRegistroTransferencia:w,getRegistrosTransferencia:R,getCurrentRegistroTransferencia:T,isLoading:E,getError:m}});export{N as u};
