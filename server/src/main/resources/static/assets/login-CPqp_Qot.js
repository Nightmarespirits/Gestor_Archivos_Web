import{_ as I,aw as k,r as o,ax as C,o as x,ay as S,k as A,y as d,e as m,w as c,aq as E,d as g,c as N,p as T,C as f,h as b,v as _,G as q}from"./index-DTzO7a71.js";import{V as B}from"./VForm-Cr0IhdhJ.js";import{V as F}from"./VAlert-WIuVYfyH.js";const L="/IESTPFFAA_logo.png",P={class:"login-bg-centered v-theme--light"},U={class:"login-card-ref"},M={__name:"login",setup(h){const y=k(),r=o(""),i=o(""),s=o(!1),t=o(!1),V=o(!1),n=o(""),u=C(),p=o(u.global.name.value);x(()=>{p.value=u.global.name.value,u.global.name.value="light"}),S(()=>{u.global.name.value=p.value});async function w(){var v,e,l;if(V.value=!0,n.value="",!r.value||!i.value){s.value=!1;return}s.value=!0;try{await y.login({username:r.value,password:i.value})}catch(a){console.error("Error de login:",a),(v=a==null?void 0:a.message)!=null&&v.includes("401")||(e=a==null?void 0:a.message)!=null&&e.includes("Invalid credentials")||(l=a==null?void 0:a.message)!=null&&l.toLowerCase().includes("credenciales")?n.value="Credenciales inválidas. Por favor, verifique su usuario y contraseña.":n.value=(a==null?void 0:a.message)||"Ocurrió un error inesperado al iniciar sesión.",setTimeout(()=>{s.value=!1},500)}}return(v,e)=>(g(),A("div",P,[d("div",U,[e[5]||(e[5]=d("img",{src:L,alt:"IESTPFFAA Logo",class:"login-logo-ref"},null,-1)),e[6]||(e[6]=d("div",{class:"login-title-ref"},"INICIAR SESIÓN",-1)),e[7]||(e[7]=d("div",{class:"login-underline-ref"},null,-1)),m(B,{onSubmit:E(w,["prevent"]),class:"login-form-ref"},{default:c(()=>[m(f,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=l=>r.value=l),label:"Nombre de Usuario",required:"","prepend-inner-icon":"mdi-account",disabled:s.value,variant:"outlined",class:"login-input-ref",color:"primary",rules:[l=>!!l||"El nombre de usuario es requerido"]},null,8,["modelValue","disabled","rules"]),m(f,{modelValue:i.value,"onUpdate:modelValue":e[1]||(e[1]=l=>i.value=l),type:t.value?"text":"password",label:"Contraseña",required:"","prepend-inner-icon":"mdi-lock","append-inner-icon":t.value?"mdi-eye-off":"mdi-eye","onClick:appendInner":e[2]||(e[2]=l=>t.value=!t.value),disabled:s.value,variant:"outlined",class:"login-input-ref",color:"primary",rules:[l=>!!l||"La contraseña es requerida"]},null,8,["modelValue","type","append-inner-icon","disabled","rules"]),n.value?(g(),N(F,{key:0,type:"error",density:"compact",class:"mb-4",variant:"tonal",closable:"","onClick:close":e[3]||(e[3]=l=>n.value="")},{default:c(()=>[b(_(n.value),1)]),_:1})):T("",!0),m(q,{color:"primary",block:"",class:"login-btn-ref",type:"submit",loading:s.value,disabled:s.value,size:"large"},{default:c(()=>e[4]||(e[4]=[b(" Ingresar ")])),_:1},8,["loading","disabled"])]),_:1})])]))}},G=I(M,[["__scopeId","data-v-e9f71856"]]);export{G as default};
