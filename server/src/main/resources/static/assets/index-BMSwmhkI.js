import{J as _e,r as w,u as Ae,K as I,L as Z,M as ee,N as ll,A as T,O as le,G as S,e,E as Q,P as ol,Q as Be,R as al,S as tl,T as sl,F as fe,U as Le,W as nl,X as rl,Y as il,Z as ul,$ as we,B as dl,a0 as Ne,a1 as cl,a2 as ml,a3 as Ue,a4 as Me,a5 as vl,a6 as Oe,a7 as We,a8 as fl,a9 as gl,aa as yl,ab as pl,ac as bl,ad as Vl,ae as wl,af as he,ag as hl,ah as xl,ai as El,aj as G,ak as Rl,al as Pl,am as Cl,an as Sl,_ as Tl,a as $l,o as kl,k as ne,w as t,ao as H,I as Dl,d as M,y as X,h as p,f as U,j as O,C as Il,H as D,n as _l,ap as Al,q as ke,c as oe,s as ae,aq as F,p as De,g as Y,v as B,ar as Bl,i as Ll,as as Nl,at as re,au as ie,t as ue,x as de,av as j,l as J}from"./index-DTzO7a71.js";import{_ as q}from"./PermissionButton-DANkCNxj.js";import{V as K,a as L}from"./VRow-DteDp9R7.js";import{a as Ie,m as Ul,b as Ml,V as Ol}from"./VChip-Bftqh3Dm.js";import{V as Wl}from"./VDataTable-BAdSe95_.js";import{V as zl}from"./VSheet-D3msx1cx.js";import{V as Gl}from"./VAutocomplete-cGRAN60C.js";import{V as Xl}from"./VAlert-WIuVYfyH.js";import{V as ce}from"./VForm-Cr0IhdhJ.js";import{V as me}from"./VSelect-DrkOLv1H.js";import{V as ve}from"./VTextarea-BbRLHrOO.js";import"./VTable-Dw3FHTEb.js";import"./filter-C-DwuyMR.js";const Yl=_e("permissions",()=>{const o=w([]),r=w([]),a=w(!1),s=w(null),v=Ae();async function y(){a.value=!0,s.value=null;try{console.log("Obteniendo permisos");const g=await I.get("/permissions",{debug:!0});o.value=g}catch(g){console.error("Error al obtener permisos:",g),s.value=g.message}finally{a.value=!1}}async function u(){a.value=!0,s.value=null;try{console.log("Obteniendo tipos de permisos");const g=await I.get("/permissions/types");r.value=g}catch(g){console.error("Error al obtener tipos de permisos:",g),s.value=g.message}finally{a.value=!1}}async function h(g){a.value=!0,s.value=null;try{console.log(`Obteniendo permiso con ID ${g}`);const c=await I.get(`/permissions/${g}`,{debug:!0});return console.log("Datos de permiso recibidos:",c),c}catch(c){return console.error(`Error al obtener permiso con ID ${g}:`,c),s.value=c.message,null}finally{a.value=!1}}async function b(g){a.value=!0,s.value=null;try{const c=await I.post("/permissions",g);return await v.createActivityLog("CREATE_PERMISSION",`Permiso "${c.name}" creado`),await y(),c}catch(c){throw console.error("Error al crear permiso:",c),s.value=c.message,c}finally{a.value=!1}}async function x(g,c){a.value=!0,s.value=null;try{console.log(`Actualizando permiso con ID ${g}`,c);const i=await I.put(`/permissions/${g}`,c,{debug:!0});return await v.createActivityLog("UPDATE_PERMISSION",`Permiso "${i.name}" actualizado`),await y(),i}catch(i){throw console.error(`Error al actualizar permiso con ID ${g}:`,i),s.value=i.message,i}finally{a.value=!1}}async function P(g){a.value=!0,s.value=null;try{return await I.delete(`/permissions/${g}`),await v.createActivityLog("DELETE_PERMISSION",`Permiso con ID ${g} eliminado`),await y(),!0}catch(c){throw console.error("Error al eliminar permiso:",c),s.value=c.message,c}finally{a.value=!1}}return{permissions:o,permissionTypes:r,loading:a,error:s,fetchPermissions:y,fetchPermissionTypes:u,fetchPermissionById:h,createPermission:b,updatePermission:x,deletePermission:P}}),ql=_e("roles",()=>{const o=w([]),r=w([]),a=w(!1),s=w(null),v=Ae();async function y(){a.value=!0,s.value=null;try{console.log("Obteniendo roles");const i=await I.get("/roles",{debug:!0});o.value=i}catch(i){console.error("Error al obtener roles:",i),s.value=i.message}finally{a.value=!1}}async function u(){a.value=!0,s.value=null;try{console.log("Obteniendo tipos de roles");const i=await I.get("/roles/types");r.value=i}catch(i){console.error("Error al obtener tipos de roles:",i),s.value=i.message}finally{a.value=!1}}async function h(i){a.value=!0,s.value=null;try{console.log(`Obteniendo rol con ID ${i}`);const d=await I.get(`/roles/${i}`,{debug:!0});return console.log("Datos de rol recibidos:",d),d}catch(d){return console.error(`Error al obtener rol con ID ${i}:`,d),s.value=d.message,null}finally{a.value=!1}}async function b(i){a.value=!0,s.value=null;try{const d=await I.post("/roles",i);return await v.createActivityLog("CREATE_ROLE",`Rol "${d.name}" creado`),await y(),d}catch(d){throw console.error("Error al crear rol:",d),s.value=d.message,d}finally{a.value=!1}}async function x(i,d){a.value=!0,s.value=null;try{console.log(`Actualizando rol con ID ${i}`,d);const f=await I.put(`/roles/${i}`,d,{debug:!0});return await v.createActivityLog("UPDATE_ROLE",`Rol "${f.name}" actualizado`),await y(),f}catch(f){throw console.error(`Error al actualizar rol con ID ${i}:`,f),s.value=f.message,f}finally{a.value=!1}}async function P(i){a.value=!0,s.value=null;try{return await I.delete(`/roles/${i}`),await v.createActivityLog("DELETE_ROLE",`Rol con ID ${i} eliminado`),await y(),!0}catch(d){throw console.error("Error al eliminar rol:",d),s.value=d.message,d}finally{a.value=!1}}async function g(i,d){a.value=!0,s.value=null;try{console.log(`Añadiendo permisos al rol con ID ${i}`,d);const f=await I.post(`/roles/${i}/permissions`,{permissionIds:d},{debug:!0});return await v.createActivityLog("ADD_PERMISSIONS_TO_ROLE",`Permisos añadidos al rol "${f.name}"`),await y(),f}catch(f){throw console.error(`Error al añadir permisos al rol con ID ${i}:`,f),s.value=f.message,f}finally{a.value=!1}}async function c(i,d){a.value=!0,s.value=null;try{console.log(`Eliminando permisos del rol con ID ${i}`,d);const f=await I.delete(`/roles/${i}/permissions`,{body:{permissionIds:d},debug:!0});return await v.createActivityLog("REMOVE_PERMISSIONS_FROM_ROLE",`Permisos eliminados del rol "${f.name}"`),await y(),f}catch(f){throw console.error(`Error al eliminar permisos del rol con ID ${i}:`,f),s.value=f.message,f}finally{a.value=!1}}return{roles:o,roleTypes:r,loading:a,error:s,fetchRoles:y,fetchRoleTypes:u,fetchRoleById:h,createRole:b,updateRole:x,deleteRole:P,addPermissionsToRole:g,removePermissionsFromRole:c}}),Re=Symbol.for("vuetify:v-tabs"),Hl=ee({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Be(al({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),xe=Z()({name:"VTab",props:Hl(),setup(o,r){let{slots:a,attrs:s}=r;const{textColorClasses:v,textColorStyles:y}=ll(o,"sliderColor"),u=w(),h=w(),b=T(()=>o.direction==="horizontal"),x=T(()=>{var g,c;return((c=(g=u.value)==null?void 0:g.group)==null?void 0:c.isSelected.value)??!1});function P(g){var i,d;let{value:c}=g;if(c){const f=(d=(i=u.value)==null?void 0:i.$el.parentElement)==null?void 0:d.querySelector(".v-tab--selected .v-tab__slider"),$=h.value;if(!f||!$)return;const W=getComputedStyle(f).color,N=f.getBoundingClientRect(),R=$.getBoundingClientRect(),E=b.value?"x":"y",C=b.value?"X":"Y",k=b.value?"right":"bottom",A=b.value?"width":"height",te=N[E],ye=R[E],z=te>ye?N[k]-R[k]:N[E]-R[E],pe=Math.sign(z)>0?b.value?"right":"bottom":Math.sign(z)<0?b.value?"left":"top":"center",be=(Math.abs(z)+(Math.sign(z)<0?N[A]:R[A]))/Math.max(N[A],R[A])||0,Ve=N[A]/R[A]||0,se=1.5;tl($,{backgroundColor:[W,"currentcolor"],transform:[`translate${C}(${z}px) scale${C}(${Ve})`,`translate${C}(${z/se}px) scale${C}(${(be-1)/se+1})`,"none"],transformOrigin:Array(3).fill(pe)},{duration:225,easing:sl})}}return le(()=>{const g=S.filterProps(o);return e(S,Q({symbol:Re,ref:u,class:["v-tab",o.class],style:o.style,tabindex:x.value?0:-1,role:"tab","aria-selected":String(x.value),active:!1},g,s,{block:o.fixed,maxWidth:o.fixed?300:void 0,"onGroup:selected":P}),{...a,default:()=>{var c;return e(fe,null,[((c=a.default)==null?void 0:c.call(a))??o.text,!o.hideSlider&&e("div",{ref:h,class:["v-tab__slider",v.value],style:y.value},null)])}})}),ol({},u)}}),Fl=o=>{const{touchstartX:r,touchendX:a,touchstartY:s,touchendY:v}=o,y=.5,u=16;o.offsetX=a-r,o.offsetY=v-s,Math.abs(o.offsetY)<y*Math.abs(o.offsetX)&&(o.left&&a<r-u&&o.left(o),o.right&&a>r+u&&o.right(o)),Math.abs(o.offsetX)<y*Math.abs(o.offsetY)&&(o.up&&v<s-u&&o.up(o),o.down&&v>s+u&&o.down(o))};function jl(o,r){var s;const a=o.changedTouches[0];r.touchstartX=a.clientX,r.touchstartY=a.clientY,(s=r.start)==null||s.call(r,{originalEvent:o,...r})}function Jl(o,r){var s;const a=o.changedTouches[0];r.touchendX=a.clientX,r.touchendY=a.clientY,(s=r.end)==null||s.call(r,{originalEvent:o,...r}),Fl(r)}function Kl(o,r){var s;const a=o.changedTouches[0];r.touchmoveX=a.clientX,r.touchmoveY=a.clientY,(s=r.move)==null||s.call(r,{originalEvent:o,...r})}function Ql(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r={touchstartX:0,touchstartY:0,touchendX:0,touchendY:0,touchmoveX:0,touchmoveY:0,offsetX:0,offsetY:0,left:o.left,right:o.right,up:o.up,down:o.down,start:o.start,move:o.move,end:o.end};return{touchstart:a=>jl(a,r),touchend:a=>Jl(a,r),touchmove:a=>Kl(a,r)}}function Zl(o,r){var h;const a=r.value,s=a!=null&&a.parent?o.parentElement:o,v=(a==null?void 0:a.options)??{passive:!0},y=(h=r.instance)==null?void 0:h.$.uid;if(!s||!y)return;const u=Ql(r.value);s._touchHandlers=s._touchHandlers??Object.create(null),s._touchHandlers[y]=u,Le(u).forEach(b=>{s.addEventListener(b,u[b],v)})}function eo(o,r){var y,u;const a=(y=r.value)!=null&&y.parent?o.parentElement:o,s=(u=r.instance)==null?void 0:u.$.uid;if(!(a!=null&&a._touchHandlers)||!s)return;const v=a._touchHandlers[s];Le(v).forEach(h=>{a.removeEventListener(h,v[h])}),delete a._touchHandlers[s]}const ze={mounted:Zl,unmounted:eo},Ge=Symbol.for("vuetify:v-window"),Xe=Symbol.for("vuetify:v-window-group"),Ye=ee({continuous:Boolean,nextIcon:{type:[Boolean,String,Function,Object],default:"$next"},prevIcon:{type:[Boolean,String,Function,Object],default:"$prev"},reverse:Boolean,showArrows:{type:[Boolean,String],validator:o=>typeof o=="boolean"||o==="hover"},touch:{type:[Object,Boolean],default:void 0},direction:{type:String,default:"horizontal"},modelValue:null,disabled:Boolean,selectedClass:{type:String,default:"v-window-item--active"},mandatory:{type:[Boolean,String],default:"force"},...Me(),...Ue(),...ml()},"VWindow"),Ee=Z()({name:"VWindow",directives:{Touch:ze},props:Ye(),emits:{"update:modelValue":o=>!0},setup(o,r){let{slots:a}=r;const{themeClasses:s}=nl(o),{isRtl:v}=rl(),{t:y}=il(),u=ul(o,Xe),h=w(),b=T(()=>v.value?!o.reverse:o.reverse),x=we(!1),P=T(()=>{const E=o.direction==="vertical"?"y":"x",k=(b.value?!x.value:x.value)?"-reverse":"";return`v-window-${E}${k}-transition`}),g=we(0),c=w(void 0),i=T(()=>u.items.value.findIndex(E=>u.selected.value.includes(E.id)));dl(i,(E,C)=>{const k=u.items.value.length,A=k-1;k<=2?x.value=E<C:E===A&&C===0?x.value=!0:E===0&&C===A?x.value=!1:x.value=E<C}),vl(Ge,{transition:P,isReversed:x,transitionCount:g,transitionHeight:c,rootRef:h});const d=T(()=>o.continuous||i.value!==0),f=T(()=>o.continuous||i.value!==u.items.value.length-1);function $(){d.value&&u.prev()}function W(){f.value&&u.next()}const N=T(()=>{const E=[],C={icon:v.value?o.nextIcon:o.prevIcon,class:`v-window__${b.value?"right":"left"}`,onClick:u.prev,"aria-label":y("$vuetify.carousel.prev")};E.push(d.value?a.prev?a.prev({props:C}):e(S,C,null):e("div",null,null));const k={icon:v.value?o.prevIcon:o.nextIcon,class:`v-window__${b.value?"left":"right"}`,onClick:u.next,"aria-label":y("$vuetify.carousel.next")};return E.push(f.value?a.next?a.next({props:k}):e(S,k,null):e("div",null,null)),E}),R=T(()=>o.touch===!1?o.touch:{...{left:()=>{b.value?$():W()},right:()=>{b.value?W():$()},start:C=>{let{originalEvent:k}=C;k.stopPropagation()}},...o.touch===!0?{}:o.touch});return le(()=>Ne(e(o.tag,{ref:h,class:["v-window",{"v-window--show-arrows-on-hover":o.showArrows==="hover"},s.value,o.class],style:o.style},{default:()=>{var E,C;return[e("div",{class:"v-window__container",style:{height:c.value}},[(E=a.default)==null?void 0:E.call(a,{group:u}),o.showArrows!==!1&&e("div",{class:"v-window__controls"},[N.value])]),(C=a.additional)==null?void 0:C.call(a,{group:u})]}}),[[cl("touch"),R.value]])),{group:u}}}),lo=ee({...Be(Ye(),["continuous","nextIcon","prevIcon","showArrows","touch","mandatory"])},"VTabsWindow"),oo=Z()({name:"VTabsWindow",props:lo(),emits:{"update:modelValue":o=>!0},setup(o,r){let{slots:a}=r;const s=Oe(Re,null),v=We(o,"modelValue"),y=T({get(){var u;return v.value!=null||!s?v.value:(u=s.items.value.find(h=>s.selected.value.includes(h.id)))==null?void 0:u.value},set(u){v.value=u}});return le(()=>{const u=Ee.filterProps(o);return e(Ee,Q({_as:"VTabsWindow"},u,{modelValue:y.value,"onUpdate:modelValue":h=>y.value=h,class:["v-tabs-window",o.class],style:o.style,mandatory:!1,touch:!1}),a)}),{}}}),qe=ee({reverseTransition:{type:[Boolean,String],default:void 0},transition:{type:[Boolean,String],default:void 0},...Me(),...Vl(),...bl()},"VWindowItem"),ge=Z()({name:"VWindowItem",directives:{Touch:ze},props:qe(),emits:{"group:selected":o=>!0},setup(o,r){let{slots:a}=r;const s=Oe(Ge),v=fl(o,Xe),{isBooted:y}=gl();if(!s||!v)throw new Error("[Vuetify] VWindowItem must be used inside VWindow");const u=we(!1),h=T(()=>y.value&&(s.isReversed.value?o.reverseTransition!==!1:o.transition!==!1));function b(){!u.value||!s||(u.value=!1,s.transitionCount.value>0&&(s.transitionCount.value-=1,s.transitionCount.value===0&&(s.transitionHeight.value=void 0)))}function x(){var d;u.value||!s||(u.value=!0,s.transitionCount.value===0&&(s.transitionHeight.value=he((d=s.rootRef.value)==null?void 0:d.clientHeight)),s.transitionCount.value+=1)}function P(){b()}function g(d){u.value&&wl(()=>{!h.value||!u.value||!s||(s.transitionHeight.value=he(d.clientHeight))})}const c=T(()=>{const d=s.isReversed.value?o.reverseTransition:o.transition;return h.value?{name:typeof d!="string"?s.transition.value:d,onBeforeEnter:x,onAfterEnter:b,onEnterCancelled:P,onBeforeLeave:x,onAfterLeave:b,onLeaveCancelled:P,onEnter:g}:!1}),{hasContent:i}=yl(o,v.isSelected);return le(()=>e(pl,{transition:c.value,disabled:!y.value},{default:()=>{var d;return[Ne(e("div",{class:["v-window-item",v.selectedClass.value,o.class],style:o.style},[i.value&&((d=a.default)==null?void 0:d.call(a))]),[[hl,v.isSelected.value]])]}})),{groupItem:v}}}),ao=ee({...qe()},"VTabsWindowItem"),to=Z()({name:"VTabsWindowItem",props:ao(),setup(o,r){let{slots:a}=r;return le(()=>{const s=ge.filterProps(o);return e(ge,Q({_as:"VTabsWindowItem"},s,{class:["v-tabs-window-item",o.class],style:o.style}),a)}),{}}});function so(o){return o?o.map(r=>Sl(r)?r:{text:r,value:r}):[]}const no=ee({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...Ul({mandatory:"force",selectedClass:"v-tab-item--selected"}),...Cl(),...Ue()},"VTabs"),ro=Z()({name:"VTabs",props:no(),emits:{"update:modelValue":o=>!0},setup(o,r){let{attrs:a,slots:s}=r;const v=We(o,"modelValue"),y=T(()=>so(o.items)),{densityClasses:u}=xl(o),{backgroundColorClasses:h,backgroundColorStyles:b}=El(G(o,"bgColor")),{scopeId:x}=Rl();return Pl({VTab:{color:G(o,"color"),direction:G(o,"direction"),stacked:G(o,"stacked"),fixed:G(o,"fixedTabs"),sliderColor:G(o,"sliderColor"),hideSlider:G(o,"hideSlider")}}),le(()=>{const P=Ie.filterProps(o),g=!!(s.window||o.items.length>0);return e(fe,null,[e(Ie,Q(P,{modelValue:v.value,"onUpdate:modelValue":c=>v.value=c,class:["v-tabs",`v-tabs--${o.direction}`,`v-tabs--align-tabs-${o.alignTabs}`,{"v-tabs--fixed-tabs":o.fixedTabs,"v-tabs--grow":o.grow,"v-tabs--stacked":o.stacked},u.value,h.value,o.class],style:[{"--v-tabs-height":he(o.height)},b.value,o.style],role:"tablist",symbol:Re},x,a),{default:()=>{var c;return[((c=s.default)==null?void 0:c.call(s))??y.value.map(i=>{var d;return((d=s.tab)==null?void 0:d.call(s,{item:i}))??e(xe,Q(i,{key:i.text,value:i.value}),{default:s[`tab.${i.value}`]?()=>{var f;return(f=s[`tab.${i.value}`])==null?void 0:f.call(s,{item:i})}:void 0})})]}}),g&&e(oo,Q({modelValue:v.value,"onUpdate:modelValue":c=>v.value=c,key:"tabs-window"},x),{default:()=>{var c;return[y.value.map(i=>{var d;return((d=s.item)==null?void 0:d.call(s,{item:i}))??e(to,{value:i.value},{default:()=>{var f;return(f=s[`item.${i.value}`])==null?void 0:f.call(s,{item:i})}})}),(c=s.window)==null?void 0:c.call(s)]}})])}),{}}}),io={class:"pa-2"},uo={key:0,class:"py-3 text-center"},co={__name:"index",setup(o){const r=Yl(),a=ql();$l();const s=w(""),v=w("permissions"),y=w(!1),u=w(!1),h=w(!1),b=w({show:!1,text:"",color:"success",timeout:3e3}),x=w({name:"",description:""}),P=w({id:null,name:"",description:""}),g=w(null);w("");const c=w(!1),i=w(!1),d=w(!1),f=w({name:"",description:""}),$=w({id:null,name:"",description:""}),W=w(null),N=w(null),R=w(null),E=w([]),C=T(()=>r.permissions),k=[{title:"ID",key:"id",sortable:!0},{title:"Nombre",key:"name",sortable:!0},{title:"Descripción",key:"description",sortable:!0},{title:"Acciones",key:"actions",sortable:!1,align:"end"}],A=T(()=>r.permissionTypes),te=T(()=>a.roleTypes);kl(async()=>{await ye(),await z(),await pe(),await Pe()});async function ye(){try{await r.fetchPermissions()}catch(m){V(`Error al cargar permisos: ${m.message}`,"error")}}async function z(){try{await r.fetchPermissionTypes()}catch(m){V(`Error al cargar tipos de permisos: ${m.message}`,"error")}}async function pe(){try{await a.fetchRoles()}catch(m){V(`Error al cargar roles: ${m.message}`,"error")}}async function Pe(){try{await a.fetchRoleTypes()}catch(m){V(`Error al cargar tipos de roles: ${m.message}`,"error")}}function be(){x.value={name:"",description:""},y.value=!0}function Ve(m){P.value={id:m.id,name:m.name,description:m.description},u.value=!0}function se(m){g.value=m,h.value=!0}async function Ce(){try{if(!x.value.name||!x.value.description)return V("Por favor complete todos los campos requeridos","error");await r.createPermission(x.value),y.value=!1,V("Permiso creado exitosamente","success")}catch(m){V(`Error al crear permiso: ${m.message}`,"error")}}async function Se(){try{if(!P.value.description)return V("Por favor complete todos los campos requeridos","error");await r.updatePermission(P.value.id,P.value),u.value=!1,V("Permiso actualizado exitosamente","success")}catch(m){V(`Error al actualizar permiso: ${m.message}`,"error")}}async function He(){try{if(!g.value)return;await r.deletePermission(g.value.id),h.value=!1,V("Permiso eliminado exitosamente","success")}catch(m){V(`Error al eliminar permiso: ${m.message}`,"error")}}function Fe(){f.value={name:"",description:""},c.value=!0}function je(m){$.value={id:m.id,name:m.name,description:m.description},i.value=!0}function Je(m){W.value=m,d.value=!0}async function Te(){try{if(!f.value.name||!f.value.description)return V("Por favor complete todos los campos requeridos","error");await a.createRole(f.value),c.value=!1,V("Rol creado exitosamente","success")}catch(m){V(`Error al crear rol: ${m.message}`,"error")}}async function $e(){try{if(!$.value.description)return V("Por favor complete todos los campos requeridos","error");await a.updateRole($.value.id,$.value),i.value=!1,V("Rol actualizado exitosamente","success")}catch(m){V(`Error al actualizar rol: ${m.message}`,"error")}}async function Ke(){try{if(!W.value)return;await a.deleteRole(W.value.id),d.value=!1,V("Rol eliminado exitosamente","success")}catch(m){V(`Error al eliminar rol: ${m.message}`,"error")}}async function Qe(m){try{if(console.log("Seleccionando rol:",m),!m){console.error("Error: El rol seleccionado no tiene ID válido",m),V("Error al seleccionar rol: ID no válido","error");return}console.log(`Cargando datos completos del rol con ID: ${m}`);const l=await a.fetchRoleById(m);l?(console.log("Datos completos del rol cargados:",l),N.value=m,R.value=l,E.value=[]):(console.error("No se pudo obtener datos completos del rol"),V("No se pudo cargar la información completa del rol","error"))}catch(l){console.error("Error al cargar detalles del rol:",l),V(`Error al cargar detalles del rol: ${l.message}`,"error")}}async function Ze(m){try{if(!R.value||!R.value.id)return V("No hay un rol seleccionado válido","error");a.removePermissionsFromRole(R.value.id,[m.id]).then(()=>(V(`Permiso ${m.name} eliminado del rol`,"success"),a.fetchRoleById(R.value.id))).then(l=>{l&&(R.value=l)}).catch(l=>{V(`Error al eliminar permiso: ${l.message}`,"error")})}catch(l){V(`Error al eliminar permiso: ${l.message}`,"error")}}async function el(){try{if(!R.value||!R.value.id)return V("No hay un rol seleccionado válido","error");if(!E.value.length)return V("Seleccione al menos un permiso para asignar","warning");await a.addPermissionsToRole(R.value.id,E.value);const m=await a.fetchRoleById(R.value.id);m&&(R.value=m),E.value=[],V("Permisos asignados exitosamente","success")}catch(m){V(`Error al asignar permisos: ${m.message}`,"error")}}function V(m,l="success",n=3e3){b.value={show:!0,text:m,color:l,timeout:n}}return(m,l)=>(M(),ne("div",null,[e(K,{class:"mb-4"},{default:t(()=>[e(L,{cols:"8"},{default:t(()=>l[26]||(l[26]=[X("h1",{class:"text-h4"},"Gestión de Permisos y Accesos",-1)])),_:1}),e(L,{cols:"4",class:"d-flex justify-end"},{default:t(()=>[e(q,{permissions:["PERMISSION_CREATE"],color:"primary","prepend-icon":"mdi-key-plus",onClick:be},{default:t(()=>l[27]||(l[27]=[p(" Nuevo Permiso ")])),_:1})]),_:1})]),_:1}),e(ro,{modelValue:v.value,"onUpdate:modelValue":l[0]||(l[0]=n=>v.value=n),"bg-color":"secondary",color:"white",class:"mb-4"},{default:t(()=>[e(xe,{value:"permissions"},{default:t(()=>l[28]||(l[28]=[p("Permisos")])),_:1}),e(xe,{value:"roles"},{default:t(()=>l[29]||(l[29]=[p("Roles y Asignaciones")])),_:1})]),_:1},8,["modelValue"]),e(Ee,{modelValue:v.value,"onUpdate:modelValue":l[3]||(l[3]=n=>v.value=n)},{default:t(()=>[e(ge,{value:"permissions"},{default:t(()=>[e(U,null,{default:t(()=>[e(O,null,{default:t(()=>[e(Il,{modelValue:s.value,"onUpdate:modelValue":l[1]||(l[1]=n=>s.value=n),"prepend-inner-icon":"mdi-magnify",label:"Buscar permiso","single-line":"","hide-details":"",clearable:"",variant:"outlined",density:"compact",class:"mb-4"},null,8,["modelValue"]),e(Wl,{headers:k,items:D(r).permissions,search:s.value,loading:D(r).loading,"items-per-page":10,class:"elevation-1"},{"item.actions":t(({item:n})=>[e(q,{permissions:["ROLE_MANAGE"],prependIcon:"mdi-pencil",iconButton:!0,color:"primary",variant:"plain",onClick:_=>Ve(n),disabled:D(r).loading,tooltip:"Editar permiso"},null,8,["onClick","disabled"]),e(q,{permissions:["ROLE_MANAGE"],prependIcon:"mdi-delete",iconButton:!0,variant:"plain",color:"error",onClick:_=>se(n),disabled:D(r).loading,tooltip:"Eliminar permiso"},null,8,["onClick","disabled"])]),_:1},8,["items","search","loading"])]),_:1})]),_:1})]),_:1}),e(ge,{value:"roles"},{default:t(()=>[e(U,null,{default:t(()=>[e(O,null,{default:t(()=>[e(K,null,{default:t(()=>[e(L,{cols:"12",md:"6"},{default:t(()=>[l[32]||(l[32]=X("h2",{class:"text-h5 mb-3"},"Gestión de Roles",-1)),e(U,{variant:"outlined",class:"mb-4"},{default:t(()=>[e(_l,null,{default:t(()=>[e(Al,null,{default:t(()=>l[30]||(l[30]=[p("Roles disponibles")])),_:1}),(M(!0),ne(fe,null,ke(D(a).roles,n=>(M(),oe(ae,{key:n.id,title:n.name,subtitle:n.description,onClick:_=>Qe(n.id),active:N.value===n.id,disabled:D(a).loading},{append:t(()=>[e(q,{roles:["SUPERADMIN"],icon:"mdi-pencil",variant:"text",color:"primary",size:"small",onClick:F(_=>je(n),["stop"])},null,8,["onClick"]),e(q,{roles:["SUPERADMIN"],icon:"mdi-delete",variant:"text",color:"error",size:"small",onClick:F(_=>Je(n),["stop"]),disabled:D(a).loading},null,8,["onClick","disabled"])]),_:2},1032,["title","subtitle","onClick","active","disabled"]))),128)),X("div",io,[e(q,{roles:["SUPERADMIN"],color:"primary",block:"","prepend-icon":"mdi-account-multiple-plus",onClick:Fe},{default:t(()=>l[31]||(l[31]=[p(" Nuevo Rol ")])),_:1})])]),_:1})]),_:1})]),_:1}),e(L,{cols:"12",md:"6"},{default:t(()=>[l[37]||(l[37]=X("h2",{class:"text-h5 mb-3"},"Permisos del Rol",-1)),R.value?(M(),oe(U,{key:0,variant:"outlined",class:"mb-4"},{default:t(()=>[e(Y,null,{default:t(()=>[p(B(R.value.name),1)]),_:1}),e(Bl,null,{default:t(()=>[p(B(R.value.description),1)]),_:1}),e(O,null,{default:t(()=>[e(zl,{class:"mb-4"},{default:t(()=>[l[34]||(l[34]=X("h3",{class:"text-subtitle-1"},"Permisos asignados",-1)),!R.value.permissions||!R.value.permissions.length?(M(),ne("div",uo,[e(Ll,{icon:"mdi-alert",color:"warning",size:"large",class:"mb-2"}),l[33]||(l[33]=X("p",null,"Este rol no tiene permisos asignados",-1))])):(M(),oe(Ml,{key:1},{default:t(()=>[(M(!0),ne(fe,null,ke(R.value.permissions,n=>(M(),oe(Ol,{key:n.id,closable:"",color:"primary",class:"ma-1","onClick:close":_=>Ze(n)},{default:t(()=>[p(B(n.name),1)]),_:2},1032,["onClick:close"]))),128))]),_:1}))]),_:1}),e(Nl,{class:"mb-4"}),l[36]||(l[36]=X("h3",{class:"text-subtitle-1 mb-2"},"Asignar nuevos permisos",-1)),e(Gl,{modelValue:E.value,"onUpdate:modelValue":l[2]||(l[2]=n=>E.value=n),items:C.value,"item-title":"name","item-value":"id",label:"Seleccionar permisos",multiple:"",chips:"","closable-chips":"",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"]),e(q,{roles:["SUPERADMIN"],color:"primary",block:"",disabled:!E.value.length||D(a).loading,onClick:el,class:"mt-2"},{default:t(()=>l[35]||(l[35]=[p(" Asignar Permisos ")])),_:1},8,["disabled"])]),_:1})]),_:1})):De("",!0),R.value?De("",!0):(M(),oe(Xl,{key:1,type:"info",text:"Seleccione un rol de la lista para gestionar sus permisos",variant:"tonal"}))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(H,{modelValue:y.value,"onUpdate:modelValue":l[7]||(l[7]=n=>y.value=n),"max-width":"600px"},{default:t(()=>[e(U,null,{default:t(()=>[e(Y,{class:"text-h5"},{default:t(()=>l[38]||(l[38]=[p("Crear Nuevo Permiso")])),_:1}),e(O,null,{default:t(()=>[e(ce,{ref:"createForm",onSubmit:F(Ce,["prevent"])},{default:t(()=>[e(K,null,{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[e(me,{modelValue:x.value.name,"onUpdate:modelValue":l[4]||(l[4]=n=>x.value.name=n),items:A.value,"item-title":"displayName","item-value":"name",label:"Tipo de Permiso",rules:[n=>!!n||"Tipo de permiso es obligatorio"],required:""},{item:t(({item:n,props:_})=>[e(ae,re(ie(_)),{default:t(()=>[e(ue,null,{default:t(()=>[p(B(n.raw.displayName),1)]),_:2},1024),e(de,null,{default:t(()=>[p(B(n.raw.description),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","rules"])]),_:1}),e(L,{cols:"12"},{default:t(()=>[e(ve,{modelValue:x.value.description,"onUpdate:modelValue":l[5]||(l[5]=n=>x.value.description=n),label:"Descripción",rules:[n=>!!n||"Descripción es obligatoria"],required:"",rows:"3"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e(j,null,{default:t(()=>[e(J),e(S,{color:"error",text:"",onClick:l[6]||(l[6]=n=>y.value=!1)},{default:t(()=>l[39]||(l[39]=[p("Cancelar")])),_:1}),e(S,{color:"primary",text:"",onClick:Ce,loading:D(r).loading},{default:t(()=>l[40]||(l[40]=[p(" Guardar ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(H,{modelValue:u.value,"onUpdate:modelValue":l[11]||(l[11]=n=>u.value=n),"max-width":"600px"},{default:t(()=>[e(U,null,{default:t(()=>[e(Y,{class:"text-h5"},{default:t(()=>l[41]||(l[41]=[p("Editar Permiso")])),_:1}),e(O,null,{default:t(()=>[e(ce,{ref:"editForm",onSubmit:F(Se,["prevent"])},{default:t(()=>[e(K,null,{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[e(me,{modelValue:P.value.name,"onUpdate:modelValue":l[8]||(l[8]=n=>P.value.name=n),items:A.value,"item-title":"displayName","item-value":"name",label:"Tipo de Permiso",rules:[n=>!!n||"Tipo de permiso es obligatorio"],required:"",disabled:""},{item:t(({item:n,props:_})=>[e(ae,re(ie(_)),{default:t(()=>[e(ue,null,{default:t(()=>[p(B(n.raw.displayName),1)]),_:2},1024),e(de,null,{default:t(()=>[p(B(n.raw.description),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","rules"])]),_:1}),e(L,{cols:"12"},{default:t(()=>[e(ve,{modelValue:P.value.description,"onUpdate:modelValue":l[9]||(l[9]=n=>P.value.description=n),label:"Descripción",rules:[n=>!!n||"Descripción es obligatoria"],required:"",rows:"3"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e(j,null,{default:t(()=>[e(J),e(S,{color:"error",text:"",onClick:l[10]||(l[10]=n=>u.value=!1)},{default:t(()=>l[42]||(l[42]=[p("Cancelar")])),_:1}),e(S,{color:"primary",text:"",onClick:Se,loading:D(r).loading},{default:t(()=>l[43]||(l[43]=[p(" Guardar ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(H,{modelValue:h.value,"onUpdate:modelValue":l[13]||(l[13]=n=>h.value=n),"max-width":"400px"},{default:t(()=>[e(U,null,{default:t(()=>[e(Y,{class:"text-h5"},{default:t(()=>l[44]||(l[44]=[p("Confirmar Eliminación")])),_:1}),e(O,null,{default:t(()=>l[45]||(l[45]=[p(" ¿Está seguro que desea eliminar este permiso? Esta acción no se puede deshacer. ")])),_:1}),e(j,null,{default:t(()=>[e(J),e(S,{color:"primary",text:"",onClick:l[12]||(l[12]=n=>h.value=!1)},{default:t(()=>l[46]||(l[46]=[p("Cancelar")])),_:1}),e(S,{color:"error",text:"",onClick:He,loading:D(r).loading},{default:t(()=>l[47]||(l[47]=[p(" Eliminar ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(H,{modelValue:c.value,"onUpdate:modelValue":l[17]||(l[17]=n=>c.value=n),"max-width":"600px"},{default:t(()=>[e(U,null,{default:t(()=>[e(Y,{class:"text-h5"},{default:t(()=>l[48]||(l[48]=[p("Crear Nuevo Rol")])),_:1}),e(O,null,{default:t(()=>[e(ce,{ref:"createRoleForm",onSubmit:F(Te,["prevent"])},{default:t(()=>[e(K,null,{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[e(me,{modelValue:f.value.name,"onUpdate:modelValue":l[14]||(l[14]=n=>f.value.name=n),items:te.value,"item-title":"displayName","item-value":"name",label:"Tipo de Rol",rules:[n=>!!n||"Tipo de rol es obligatorio"],required:""},{item:t(({item:n,props:_})=>[e(ae,re(ie(_)),{default:t(()=>[e(ue,null,{default:t(()=>[p(B(n.raw.displayName),1)]),_:2},1024),e(de,null,{default:t(()=>[p(B(n.raw.description),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","rules"])]),_:1}),e(L,{cols:"12"},{default:t(()=>[e(ve,{modelValue:f.value.description,"onUpdate:modelValue":l[15]||(l[15]=n=>f.value.description=n),label:"Descripción",rules:[n=>!!n||"Descripción es obligatoria"],required:"",rows:"3"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e(j,null,{default:t(()=>[e(J),e(S,{color:"error",text:"",onClick:l[16]||(l[16]=n=>c.value=!1)},{default:t(()=>l[49]||(l[49]=[p("Cancelar")])),_:1}),e(S,{color:"primary",text:"",onClick:Te,loading:D(a).loading},{default:t(()=>l[50]||(l[50]=[p(" Guardar ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(H,{modelValue:i.value,"onUpdate:modelValue":l[21]||(l[21]=n=>i.value=n),"max-width":"600px"},{default:t(()=>[e(U,null,{default:t(()=>[e(Y,{class:"text-h5"},{default:t(()=>l[51]||(l[51]=[p("Editar Rol")])),_:1}),e(O,null,{default:t(()=>[e(ce,{ref:"editRoleForm",onSubmit:F($e,["prevent"])},{default:t(()=>[e(K,null,{default:t(()=>[e(L,{cols:"12"},{default:t(()=>[e(me,{modelValue:$.value.name,"onUpdate:modelValue":l[18]||(l[18]=n=>$.value.name=n),items:te.value,"item-title":"displayName","item-value":"name",label:"Tipo de Rol",rules:[n=>!!n||"Tipo de rol es obligatorio"],required:"",disabled:""},{item:t(({item:n,props:_})=>[e(ae,re(ie(_)),{default:t(()=>[e(ue,null,{default:t(()=>[p(B(n.raw.displayName),1)]),_:2},1024),e(de,null,{default:t(()=>[p(B(n.raw.description),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items","rules"])]),_:1}),e(L,{cols:"12"},{default:t(()=>[e(ve,{modelValue:$.value.description,"onUpdate:modelValue":l[19]||(l[19]=n=>$.value.description=n),label:"Descripción",rules:[n=>!!n||"Descripción es obligatoria"],required:"",rows:"3"},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},512)]),_:1}),e(j,null,{default:t(()=>[e(J),e(S,{color:"error",text:"",onClick:l[20]||(l[20]=n=>i.value=!1)},{default:t(()=>l[52]||(l[52]=[p("Cancelar")])),_:1}),e(S,{color:"primary",text:"",onClick:$e,loading:D(a).loading},{default:t(()=>l[53]||(l[53]=[p(" Guardar ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(H,{modelValue:d.value,"onUpdate:modelValue":l[23]||(l[23]=n=>d.value=n),"max-width":"400px"},{default:t(()=>[e(U,null,{default:t(()=>[e(Y,{class:"text-h5"},{default:t(()=>l[54]||(l[54]=[p("Confirmar Eliminación")])),_:1}),e(O,null,{default:t(()=>l[55]||(l[55]=[p(" ¿Está seguro que desea eliminar este rol? Esta acción no se puede deshacer y podría afectar a usuarios con este rol asignado. ")])),_:1}),e(j,null,{default:t(()=>[e(J),e(S,{color:"primary",text:"",onClick:l[22]||(l[22]=n=>d.value=!1)},{default:t(()=>l[56]||(l[56]=[p("Cancelar")])),_:1}),e(S,{color:"error",text:"",onClick:Ke,loading:D(a).loading},{default:t(()=>l[57]||(l[57]=[p(" Eliminar ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Dl,{modelValue:b.value.show,"onUpdate:modelValue":l[25]||(l[25]=n=>b.value.show=n),color:b.value.color,timeout:b.value.timeout},{actions:t(()=>[e(S,{color:"white",text:"",onClick:l[24]||(l[24]=n=>b.value.show=!1)},{default:t(()=>l[58]||(l[58]=[p(" Cerrar ")])),_:1})]),default:t(()=>[p(B(b.value.text)+" ",1)]),_:1},8,["modelValue","color","timeout"])]))}},Po=Tl(co,[["__scopeId","data-v-8c0f1741"]]);export{Po as default};
