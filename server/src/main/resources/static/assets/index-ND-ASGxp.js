import{a as Y,A as N,aU as Z,r as S,o as h,k as O,e as l,w as e,V as ee,ao as le,I as ae,F as B,b as te,d as v,f as g,g as D,y as p,c as _,p as y,G as C,h as t,j as b,v as o,as as R,n as I,ap as w,s as d,t as r,x as s,i as u,l as M,av as oe}from"./index-DTzO7a71.js";import{u as ne}from"./catalogo-transferencia-D9ScGTOQ.js";import{V as $}from"./VAlert-WIuVYfyH.js";import{V as L}from"./VChip-Bftqh3Dm.js";import{V as T,a as x}from"./VRow-DteDp9R7.js";import{V as ue}from"./VDataTable-BAdSe95_.js";import"./VSelect-DrkOLv1H.js";import"./VTable-Dw3FHTEb.js";import"./filter-C-DwuyMR.js";const ie={class:"d-flex justify-space-between align-center mb-4"},de={class:"text-h5"},re={class:"d-flex align-center mb-4"},se=["title"],fe={class:"text-h4"},me={class:"text-h4"},ce={class:"text-h4"},pe={class:"text-h4"},ve={class:"d-flex flex-wrap gap-3"},we={__name:"index",setup(ge){const z=Z(),q=te(),V=ne(),G=Y(),A=N(()=>z.params.id);N(()=>V.isLoading());const k=S(null),n=N(()=>V.getCurrentCatalogoTransferencia()),U=S(!1),c=S(null),E=S({show:!1,text:"",color:"success",timeout:3e3}),H=[{title:"Nº Item",key:"numeroItem",sortable:!0},{title:"Nº Caja",key:"numeroCaja",sortable:!0},{title:"Nº Tomo/Paquete",key:"numeroTomoPaquete",sortable:!0},{title:"Nº Unidad Documental",key:"numeroUnidadDocumental",sortable:!0},{title:"Fecha",key:"fechaUnidadDocumental",sortable:!0},{title:"Contenido",key:"alcanceContenido",sortable:!1},{title:"Folios",key:"cantidadFolios",sortable:!0},{title:"Acciones",key:"actions",sortable:!1,align:"center"}],j=N(()=>G.hasPermission("DOCUMENT_CREATE")),J=N(()=>{var i;return(i=n.value)!=null&&i.detalles?n.value.detalles.reduce((a,m)=>a+(m.cantidadFolios||0),0):0}),K=N(()=>{var a;return(a=n.value)!=null&&a.detalles?new Set(n.value.detalles.map(m=>m.numeroCaja).filter(m=>m&&m.trim()!=="")).size:0});h(async()=>{try{const i=await V.fetchCatalogoTransferenciaById(A.value);console.log("data",i),console.log("catalogo.value",V.getCurrentCatalogoTransferencia()),n.value||(k.value="No se encontró el catálogo de transferencia solicitado")}catch(i){k.value=`Error al cargar el catálogo: ${i.message}`,console.error("Error:",i)}});async function P(i){try{await V.exportCatalogoToExcel(A.value)}catch(a){k.value=`Error al descargar: ${a.message}`,console.error("Error:",a)}}async function Q(){if(n.value&&confirm("¿Está seguro que desea eliminar este catálogo de transferencia?"))try{await V.deleteCatalogoTransferencia(A.value)&&(showSnackbar("Documento Eliminado Correctamente:"),q.push({name:"catalogo-transferencia-list"}))}catch(i){k.value=`Error al eliminar: ${i.message}`,console.error("Error:",i)}}function W(i){c.value=i,U.value=!0}function F(i){if(!i)return"N/A";try{const a=new Date(i);return new Intl.DateTimeFormat("es-ES",{year:"numeric",month:"long",day:"numeric"}).format(a)}catch{return i}}function X(i){switch(i){case"PAPEL":return"brown";case"DIGITAL":return"blue";case"AUDIOVISUAL":return"purple";case"MICROFILM":return"grey";case"OTRO":return"orange";default:return"grey"}}return(i,a)=>(v(),O(B,null,[l(ee,{fluid:""},{default:e(()=>[l(g,null,{default:e(()=>[l(D,{class:"d-flex justify-space-between"},{default:e(()=>[a[7]||(a[7]=p("span",null,"Detalle de Catálogo de Transferencia",-1)),p("div",null,[j.value?(v(),_(C,{key:0,color:"warning","prepend-icon":"mdi-pencil",to:{name:"catalogo-transferencia-edit",params:{id:A.value}},class:"mr-2"},{default:e(()=>a[5]||(a[5]=[t(" Editar ")])),_:1},8,["to"])):y("",!0),l(C,{color:"primary","prepend-icon":"mdi-arrow-left",to:{name:"catalogo-transferencia-list"}},{default:e(()=>a[6]||(a[6]=[t(" Volver ")])),_:1})])]),_:1}),l(b,null,{default:e(()=>{var m;return[k.value?(v(),_($,{key:0,type:"error",title:"Error",text:k.value,class:"mb-4"},null,8,["text"])):n.value?(v(),O(B,{key:1},[p("div",ie,[p("h2",de,o(n.value.codigoReferencia||"Sin código"),1),l(L,{color:X(n.value.soporte),"text-color":"white"},{default:e(()=>[t(o(n.value.soporte||"No especificado"),1)]),_:1},8,["color"])]),l(R,{class:"mb-4"}),l(T,null,{default:e(()=>[l(x,{cols:"12",md:"6"},{default:e(()=>[l(I,null,{default:e(()=>[l(w,null,{default:e(()=>a[8]||(a[8]=[t("Información de la Entidad")])),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-domain"})]),default:e(()=>[l(r,null,{default:e(()=>a[9]||(a[9]=[t("Nombre Entidad")])),_:1}),l(s,null,{default:e(()=>[t(o(n.value.nombreEntidad||"No especificado"),1)]),_:1})]),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-office-building"})]),default:e(()=>[l(r,null,{default:e(()=>a[10]||(a[10]=[t("Unidad de Organización")])),_:1}),l(s,null,{default:e(()=>[t(o(n.value.unidadOrganizacion||"No especificado"),1)]),_:1})]),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-folder"})]),default:e(()=>[l(r,null,{default:e(()=>a[11]||(a[11]=[t("Sección")])),_:1}),l(s,null,{default:e(()=>[t(o(n.value.seccion||"No especificado"),1)]),_:1})]),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-layers"})]),default:e(()=>[l(r,null,{default:e(()=>a[12]||(a[12]=[t("Nivel de Descripción")])),_:1}),l(s,null,{default:e(()=>[t(o(n.value.nivelDescripcion||"No especificado"),1)]),_:1})]),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-file-document-multiple"})]),default:e(()=>[l(r,null,{default:e(()=>a[13]||(a[13]=[t("Serie Documental")])),_:1}),l(s,null,{default:e(()=>[t(o(n.value.serieDocumental||"No especificado"),1)]),_:1})]),_:1})]),_:1})]),_:1}),l(x,{cols:"12",md:"6"},{default:e(()=>[l(I,null,{default:e(()=>[l(w,null,{default:e(()=>a[14]||(a[14]=[t("Información Técnica")])),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-barcode"})]),default:e(()=>[l(r,null,{default:e(()=>a[15]||(a[15]=[t("Código de Referencia")])),_:1}),l(s,null,{default:e(()=>[t(o(n.value.codigoReferencia||"No especificado"),1)]),_:1})]),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-file"})]),default:e(()=>[l(r,null,{default:e(()=>a[16]||(a[16]=[t("Soporte")])),_:1}),l(s,null,{default:e(()=>[t(o(n.value.soporte||"No especificado"),1)]),_:1})]),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-ruler"})]),default:e(()=>[l(r,null,{default:e(()=>a[17]||(a[17]=[t("Volumen (metros lineales)")])),_:1}),l(s,null,{default:e(()=>[t(o(n.value.volumenMetrosLineales||"0")+" m",1)]),_:1})]),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-calendar-clock"})]),default:e(()=>[l(r,null,{default:e(()=>a[18]||(a[18]=[t("Fecha Creación")])),_:1}),l(s,null,{default:e(()=>[t(o(F(n.value.createdAt)),1)]),_:1})]),_:1}),n.value.updatedAt?(v(),_(d,{key:0},{prepend:e(()=>[l(u,{icon:"mdi-calendar-edit"})]),default:e(()=>[l(r,null,{default:e(()=>a[19]||(a[19]=[t("Última Actualización")])),_:1}),l(s,null,{default:e(()=>[t(o(F(n.value.updatedAt)),1)]),_:1})]),_:1})):y("",!0)]),_:1})]),_:1})]),_:1}),l(R,{class:"my-4"}),l(T,null,{default:e(()=>[l(x,{cols:"12",md:"6"},{default:e(()=>[l(I,null,{default:e(()=>[l(w,null,{default:e(()=>a[20]||(a[20]=[t("Responsables")])),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-account-tie"})]),default:e(()=>[l(r,null,{default:e(()=>a[21]||(a[21]=[t("Responsable de Sección")])),_:1}),l(s,null,{default:e(()=>[t(o(n.value.responsableSeccion||"No especificado"),1)]),_:1})]),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-account-edit"})]),default:e(()=>[l(r,null,{default:e(()=>a[22]||(a[22]=[t("Elaborado por")])),_:1}),l(s,null,{default:e(()=>[t(o(n.value.inventarioElaboradoPor||"No especificado"),1)]),_:1})]),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-account-check"})]),default:e(()=>[l(r,null,{default:e(()=>a[23]||(a[23]=[t("Visto Bueno")])),_:1}),l(s,null,{default:e(()=>[t(o(n.value.vistoBuenoResponsable||"No especificado"),1)]),_:1})]),_:1})]),_:1})]),_:1}),l(x,{cols:"12",md:"6"},{default:e(()=>[l(I,null,{default:e(()=>[l(w,null,{default:e(()=>a[24]||(a[24]=[t("Información Adicional")])),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-file-send"})]),default:e(()=>[l(r,null,{default:e(()=>a[25]||(a[25]=[t("Número/Año Remisión")])),_:1}),l(s,null,{default:e(()=>[t(o(n.value.numeroAnioRemision||"No especificado"),1)]),_:1})]),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-map-marker-radius"})]),default:e(()=>[l(r,null,{default:e(()=>a[26]||(a[26]=[t("Lugar y Fecha de Elaboración")])),_:1}),l(s,null,{default:e(()=>[t(o(n.value.lugarFechaElaboracion||"No especificado"),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),n.value.observaciones?(v(),_(T,{key:0},{default:e(()=>[l(x,{cols:"12"},{default:e(()=>[l(g,{variant:"outlined",color:"background"},{default:e(()=>[l(D,{class:"text-subtitle-1"},{default:e(()=>[l(u,{start:"",icon:"mdi-information-outline"}),a[27]||(a[27]=t(" Observaciones "))]),_:1}),l(b,{class:"text-body-1"},{default:e(()=>[t(o(n.value.observaciones),1)]),_:1})]),_:1})]),_:1})]),_:1})):y("",!0),l(R,{class:"my-6"}),p("div",re,[a[28]||(a[28]=p("h3",{class:"text-h5"},"Detalles del Catálogo",-1)),l(M),l(L,{color:((m=n.value.detalles)==null?void 0:m.length)>0?"success":"warning","text-color":"white"},{default:e(()=>{var f;return[t(o(((f=n.value.detalles)==null?void 0:f.length)||0)+" ítems ",1)]}),_:1},8,["color"])]),l(g,{variant:"outlined",class:"mb-4"},{default:e(()=>[l(b,null,{default:e(()=>[n.value.detalles&&n.value.detalles.length>0?(v(),_(ue,{key:0,headers:H,items:n.value.detalles,"items-per-page":10,"item-value":"id",class:"elevation-0"},{"item.numeroItem":e(({item:f})=>[l(L,{size:"small",color:"primary",variant:"outlined"},{default:e(()=>[t(o(f.numeroItem),1)]),_:2},1024)]),"item.fechaUnidadDocumental":e(({item:f})=>[t(o(f.fechaUnidadDocumental?F(f.fechaUnidadDocumental):"-"),1)]),"item.alcanceContenido":e(({item:f})=>[p("div",{class:"text-truncate",style:{"max-width":"200px"},title:f.alcanceContenido},o(f.alcanceContenido||"-"),9,se)]),"item.cantidadFolios":e(({item:f})=>[l(L,{size:"small",color:"info",variant:"outlined"},{default:e(()=>[t(o(f.cantidadFolios||0)+" folios ",1)]),_:2},1024)]),"item.actions":e(({item:f})=>[l(C,{icon:"mdi-eye",size:"small",variant:"text",color:"primary",onClick:_e=>W(f),title:`Ver detalle del ítem ${f.numeroItem}`},null,8,["onClick","title"])]),_:1},8,["items"])):(v(),_($,{key:1,type:"info",text:"No hay detalles registrados en este catálogo de transferencia.",variant:"tonal",class:"mt-2"}))]),_:1})]),_:1}),l(T,{class:"mb-4"},{default:e(()=>[l(x,{cols:"12",md:"3"},{default:e(()=>[l(g,{color:"primary",variant:"tonal"},{default:e(()=>[l(b,{class:"text-center"},{default:e(()=>{var f;return[p("div",fe,o(((f=n.value.detalles)==null?void 0:f.length)||0),1),a[29]||(a[29]=p("div",{class:"text-subtitle-1"},"Total Ítems",-1))]}),_:1})]),_:1})]),_:1}),l(x,{cols:"12",md:"3"},{default:e(()=>[l(g,{color:"success",variant:"tonal"},{default:e(()=>[l(b,{class:"text-center"},{default:e(()=>[p("div",me,o(J.value),1),a[30]||(a[30]=p("div",{class:"text-subtitle-1"},"Total Folios",-1))]),_:1})]),_:1})]),_:1}),l(x,{cols:"12",md:"3"},{default:e(()=>[l(g,{color:"info",variant:"tonal"},{default:e(()=>[l(b,{class:"text-center"},{default:e(()=>[p("div",ce,o(K.value),1),a[31]||(a[31]=p("div",{class:"text-subtitle-1"},"Total Cajas",-1))]),_:1})]),_:1})]),_:1}),l(x,{cols:"12",md:"3"},{default:e(()=>[l(g,{color:"warning",variant:"tonal"},{default:e(()=>[l(b,{class:"text-center"},{default:e(()=>[p("div",pe,o(n.value.volumenMetrosLineales||0)+"m",1),a[32]||(a[32]=p("div",{class:"text-subtitle-1"},"Metros Lineales",-1))]),_:1})]),_:1})]),_:1})]),_:1}),p("div",ve,[l(C,{color:"primary","prepend-icon":"mdi-printer",onClick:a[0]||(a[0]=f=>P("pdf"))},{default:e(()=>a[33]||(a[33]=[t(" Imprimir PDF ")])),_:1}),l(C,{color:"success","prepend-icon":"mdi-microsoft-excel",onClick:a[1]||(a[1]=f=>P("excel"))},{default:e(()=>a[34]||(a[34]=[t(" Descargar Excel ")])),_:1}),j.value?(v(),_(C,{key:0,color:"error","prepend-icon":"mdi-delete",onClick:Q},{default:e(()=>a[35]||(a[35]=[t(" Eliminar ")])),_:1})):y("",!0)])],64)):y("",!0)]}),_:1})]),_:1})]),_:1}),l(le,{modelValue:U.value,"onUpdate:modelValue":a[3]||(a[3]=m=>U.value=m),"max-width":"900px",scrollable:""},{default:e(()=>[l(g,null,{default:e(()=>[l(D,{class:"d-flex align-center"},{default:e(()=>{var m;return[l(u,{start:"",icon:"mdi-file-document-outline"}),t(" Detalle del Ítem "+o((m=c.value)==null?void 0:m.numeroItem),1)]}),_:1}),l(b,null,{default:e(()=>[c.value?(v(),_(T,{key:0},{default:e(()=>[l(x,{cols:"12",md:"6"},{default:e(()=>[l(I,null,{default:e(()=>[l(w,null,{default:e(()=>a[36]||(a[36]=[t("Información Básica")])),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-numeric"})]),default:e(()=>[l(r,null,{default:e(()=>a[37]||(a[37]=[t("Número de Item")])),_:1}),l(s,null,{default:e(()=>[t(o(c.value.numeroItem),1)]),_:1})]),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-package-variant"})]),default:e(()=>[l(r,null,{default:e(()=>a[38]||(a[38]=[t("Número de Caja")])),_:1}),l(s,null,{default:e(()=>[t(o(c.value.numeroCaja||"No especificado"),1)]),_:1})]),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-book"})]),default:e(()=>[l(r,null,{default:e(()=>a[39]||(a[39]=[t("Número de Tomo/Paquete")])),_:1}),l(s,null,{default:e(()=>[t(o(c.value.numeroTomoPaquete||"No especificado"),1)]),_:1})]),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-file-document"})]),default:e(()=>[l(r,null,{default:e(()=>a[40]||(a[40]=[t("Número de Unidad Documental")])),_:1}),l(s,null,{default:e(()=>[t(o(c.value.numeroUnidadDocumental||"No especificado"),1)]),_:1})]),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-calendar"})]),default:e(()=>[l(r,null,{default:e(()=>a[41]||(a[41]=[t("Fecha de Unidad Documental")])),_:1}),l(s,null,{default:e(()=>[t(o(c.value.fechaUnidadDocumental?F(c.value.fechaUnidadDocumental):"No especificado"),1)]),_:1})]),_:1}),l(d,null,{prepend:e(()=>[l(u,{icon:"mdi-file-multiple"})]),default:e(()=>[l(r,null,{default:e(()=>a[42]||(a[42]=[t("Cantidad de Folios")])),_:1}),l(s,null,{default:e(()=>[t(o(c.value.cantidadFolios||0),1)]),_:1})]),_:1})]),_:1})]),_:1}),l(x,{cols:"12",md:"6"},{default:e(()=>[l(I,null,{default:e(()=>[l(w,null,{default:e(()=>a[43]||(a[43]=[t("Contenido y Observaciones")])),_:1}),c.value.alcanceContenido?(v(),_(g,{key:0,variant:"outlined",class:"mb-3"},{default:e(()=>[l(D,{class:"text-subtitle-1"},{default:e(()=>[l(u,{start:"",icon:"mdi-text-box-outline"}),a[44]||(a[44]=t(" Alcance y Contenido "))]),_:1}),l(b,{class:"text-body-2"},{default:e(()=>[t(o(c.value.alcanceContenido),1)]),_:1})]),_:1})):y("",!0),c.value.informacionAdicional?(v(),_(g,{key:1,variant:"outlined",class:"mb-3"},{default:e(()=>[l(D,{class:"text-subtitle-1"},{default:e(()=>[l(u,{start:"",icon:"mdi-information"}),a[45]||(a[45]=t(" Información Adicional "))]),_:1}),l(b,{class:"text-body-2"},{default:e(()=>[t(o(c.value.informacionAdicional),1)]),_:1})]),_:1})):y("",!0),c.value.observaciones?(v(),_(g,{key:2,variant:"outlined"},{default:e(()=>[l(D,{class:"text-subtitle-1"},{default:e(()=>[l(u,{start:"",icon:"mdi-note-text"}),a[46]||(a[46]=t(" Observaciones "))]),_:1}),l(b,{class:"text-body-2"},{default:e(()=>[t(o(c.value.observaciones),1)]),_:1})]),_:1})):y("",!0)]),_:1})]),_:1})]),_:1})):y("",!0)]),_:1}),l(oe,null,{default:e(()=>[l(M),l(C,{variant:"text",onClick:a[2]||(a[2]=m=>U.value=!1)},{default:e(()=>a[47]||(a[47]=[t(" Cerrar ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(ae,{modelValue:E.value.show,"onUpdate:modelValue":a[4]||(a[4]=m=>E.value.show=m),color:E.value.color,timeout:E.value.timeout},{default:e(()=>[t(o(E.value.text),1)]),_:1},8,["modelValue","color","timeout"])],64))}};export{we as default};
