import{aw as A,A as c,aU as D,r as f,o as B,B as L,c as p,w as t,V as z,b as N,d as V,e as a,f as O,g as I,y as b,G as m,h as v,j as M,aq as P,C as r,bw as F}from"./index-DTzO7a71.js";import{u as k}from"./catalogo-transferencia-D9ScGTOQ.js";import{V as E,a as n}from"./VRow-DteDp9R7.js";import{V as q}from"./VAlert-WIuVYfyH.js";import{V as G}from"./VForm-Cr0IhdhJ.js";import{V as j}from"./VSelect-DrkOLv1H.js";import{V as $}from"./VTextarea-BbRLHrOO.js";import"./VChip-Bftqh3Dm.js";const H={class:"d-flex flex-column flex-sm-row gap-2 mt-5"},ee={__name:"edit",setup(J){const R=D(),U=N(),d=k();A();const{showSuccess:y,showError:x}=F(),i=c(()=>R.params.id),w=c(()=>d.isLoading()),s=f(null),g=f(null),C=c(()=>d.getCurrentCatalogoTransferencia()),o=f({nombreEntidad:"",unidadOrganizacion:"",seccion:"",nivelDescripcion:"",serieDocumental:"",codigoReferencia:"",volumenMetrosLineales:0,responsableSeccion:"",inventarioElaboradoPor:"",numeroAnioRemision:"",lugarFechaElaboracion:"",vistoBuenoResponsable:"",soporte:"PAPEL",observaciones:""}),S=["PAPEL","DIGITAL","AUDIOVISUAL","MICROFILM","OTRO"];B(async()=>{try{await d.fetchCatalogoTransferenciaById(i.value),C.value||(s.value="No se encontró el catálogo de transferencia solicitado")}catch(u){s.value=`Error al cargar el catálogo: ${u.message}`}}),L(C,u=>{u&&(o.value={...u})},{immediate:!0});async function T(){if(g.value.validate())try{await d.updateCatalogoTransferencia(i.value,o.value)&&(y("Catálogo de transferencia actualizado con éxito"),setTimeout(()=>{U.push({name:"catalogo-transferencia-detalle",params:{id:i.value}})},1e3))}catch(u){x(`Error al actualizar el catálogo: ${u.message}`),console.error("Error:",u)}}return(u,e)=>(V(),p(z,{fluid:""},{default:t(()=>[a(O,null,{default:t(()=>[a(I,{class:"d-flex justify-space-between"},{default:t(()=>[e[16]||(e[16]=b("span",null,"Editar Catálogo de Transferencia",-1)),a(E,{class:"mt-4"},{default:t(()=>[a(n,{cols:"12",class:"d-flex justify-space-between"},{default:t(()=>[a(m,{color:"info",variant:"outlined",to:{name:"catalogo-transferencia-detalles",params:{id:i.value}},"prepend-icon":"mdi-table-edit"},{default:t(()=>e[14]||(e[14]=[v(" Gestionar Detalles ")])),_:1},8,["to"]),b("div",null,[a(m,{color:"error",variant:"outlined",to:{name:"catalogo-transferencia-detalle",params:{id:i.value}},class:"ml-2"},{default:t(()=>e[15]||(e[15]=[v(" Cancelar ")])),_:1},8,["to"])])]),_:1})]),_:1})]),_:1}),a(M,null,{default:t(()=>[s.value?(V(),p(q,{key:0,type:"error",title:"Error",text:s.value,class:"mb-4"},null,8,["text"])):(V(),p(G,{key:1,ref_key:"form",ref:g,onSubmit:P(T,["prevent"])},{default:t(()=>[a(E,null,{default:t(()=>[a(n,{cols:"12",md:"6"},{default:t(()=>[a(r,{modelValue:o.value.nombreEntidad,"onUpdate:modelValue":e[0]||(e[0]=l=>o.value.nombreEntidad=l),label:"Nombre Entidad",rules:[l=>!!l||"Nombre de entidad es requerido"],required:"",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12",md:"6"},{default:t(()=>[a(r,{modelValue:o.value.unidadOrganizacion,"onUpdate:modelValue":e[1]||(e[1]=l=>o.value.unidadOrganizacion=l),label:"Unidad de Organización",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",md:"6"},{default:t(()=>[a(r,{modelValue:o.value.seccion,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.seccion=l),label:"Sección",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",md:"6"},{default:t(()=>[a(r,{modelValue:o.value.nivelDescripcion,"onUpdate:modelValue":e[3]||(e[3]=l=>o.value.nivelDescripcion=l),label:"Nivel de Descripción",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",md:"6"},{default:t(()=>[a(r,{modelValue:o.value.serieDocumental,"onUpdate:modelValue":e[4]||(e[4]=l=>o.value.serieDocumental=l),label:"Serie Documental",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",md:"6"},{default:t(()=>[a(r,{modelValue:o.value.codigoReferencia,"onUpdate:modelValue":e[5]||(e[5]=l=>o.value.codigoReferencia=l),label:"Código de Referencia",required:"",rules:[l=>!!l||"Código de referencia es requerido"],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12",md:"6"},{default:t(()=>[a(j,{modelValue:o.value.soporte,"onUpdate:modelValue":e[6]||(e[6]=l=>o.value.soporte=l),items:S,label:"Soporte",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",md:"6"},{default:t(()=>[a(r,{modelValue:o.value.volumenMetrosLineales,"onUpdate:modelValue":e[7]||(e[7]=l=>o.value.volumenMetrosLineales=l),label:"Volumen (metros lineales)",type:"number",step:"0.01",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",md:"6"},{default:t(()=>[a(r,{modelValue:o.value.responsableSeccion,"onUpdate:modelValue":e[8]||(e[8]=l=>o.value.responsableSeccion=l),label:"Responsable de Sección",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",md:"6"},{default:t(()=>[a(r,{modelValue:o.value.inventarioElaboradoPor,"onUpdate:modelValue":e[9]||(e[9]=l=>o.value.inventarioElaboradoPor=l),label:"Elaborado por",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",md:"6"},{default:t(()=>[a(r,{modelValue:o.value.numeroAnioRemision,"onUpdate:modelValue":e[10]||(e[10]=l=>o.value.numeroAnioRemision=l),label:"Número/Año Remisión",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",md:"6"},{default:t(()=>[a(r,{modelValue:o.value.lugarFechaElaboracion,"onUpdate:modelValue":e[11]||(e[11]=l=>o.value.lugarFechaElaboracion=l),label:"Lugar y fecha de elaboración",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",md:"6"},{default:t(()=>[a(r,{modelValue:o.value.vistoBuenoResponsable,"onUpdate:modelValue":e[12]||(e[12]=l=>o.value.vistoBuenoResponsable=l),label:"Visto Bueno Responsable",variant:"outlined"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12"},{default:t(()=>[a($,{modelValue:o.value.observaciones,"onUpdate:modelValue":e[13]||(e[13]=l=>o.value.observaciones=l),label:"Observaciones",variant:"outlined",rows:"3"},null,8,["modelValue"])]),_:1})]),_:1}),b("div",H,[a(m,{color:"primary",type:"submit",size:"large",loading:w.value,"prepend-icon":"mdi-content-save"},{default:t(()=>e[17]||(e[17]=[v(" Guardar Cambios ")])),_:1},8,["loading"]),a(m,{color:"secondary",variant:"outlined",size:"large",to:{name:"catalogo-transferencia-detalle",params:{id:i.value}}},{default:t(()=>e[18]||(e[18]=[v(" Cancelar ")])),_:1},8,["to"])])]),_:1},512))]),_:1})]),_:1})]),_:1}))}};export{ee as default};
